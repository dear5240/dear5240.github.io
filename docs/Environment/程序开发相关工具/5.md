# 5. 下载目录工具说明

本章节是下载目录中各工具的使用说明

## 5.1. fat_image_tool工具介绍

### 5.1.1. 说明

fat_image_tool是一个用于生成FAT文件系统镜像数据的命令行工具。 该工具随SDK发布。

fat_image_tool支持以下参数：

| 参数                 | 说明                                                         |
| -------------------- | ------------------------------------------------------------ |
| –silent 1            | 安静模式，不显示镜像文件生成过程的输出信息                   |
| –lfn                 | 是否支持长文件名，默认不支持                                 |
| –type                | 文件系统类型，支持的文件系统如下： FAT32、FAT16、FAT12、AUTO 缺省值为 AUTO，自动根据文件数量和大小选择合适的文件系统类型 |
| –n-root              | 根目录最大文件个数，缺省值为 512                             |
| –size                | 设置文件系统最大容量，缺省值为 AUTO，工具根据所有文件的总大小设置合适的容量 |
| –volume-name         | 设置卷标，缺省值为空                                         |
| –fat-dir             | 设置用于生成FAT文件系统镜像的文件目录， 如果为空，那么生成一个没有任何文件的镜像 |
| –sectors-per-cluster | 设置每个簇的扇区个数， 缺省值为 1， 每个扇区的大小是512字节  |
| –output              | 输出的镜像文件名                                             |

### 5.1.2. 示例脚本

1. 使用image_files目录下的文件生成FAT镜像

```
fat_image_tool.exe --lfn true --type AUTO --n-root 1024 --size AUTO --fat-dir image_files --sectors-per-cluster 0x8  --output disk.img 
```

1. 生成一个没有任何文件的FAT32镜像

```
fat_image_tool.exe --lfn true --type FAT32 --n-root 512 --size 64M --sectors-per-cluster 0x1 --output empty.img
```

### 5.1.3. 常见错误处理方式

出现错误时，通常为指定的参数无法文件系统镜像数据，请根据文件目录实际情况调整参数。

- 如根目录文件个数超过512时， 需要通过`--n-root`参数修改根目录文件上限。
- 如文件比较大时，需要通过`--sectors-per-cluster`修改每个簇的扇区个数。
- 如指定了文件系统为FAT12，但是所有文件大小总和超过了FAT12上限，需要通过`--type`设置文件系列类型为FAT16或者FAT32。

FAT类型文件卷大小范围：

| FAT类型 | 卷大小范围 |
| ------- | ---------- |
| FAT12   | ~ 128M     |
| FAT16   | 2M ~ 2G    |
| FAT32   | 32M ~ 2TB  |
