# 8. OTA&本地升级

## 8.1. 手机OTA升级

**1、程序配置**

![img183](/pic/183.png)

**2、手机下载杰理OTA应用程序**

![img184](/pic/184.png)

**3、将ufw文件传到手机，使用杰理OTA程序连接样机并升级**

![img185](/pic/185.png)

**注意点：**

1. 升级文件key文件必须与样机一致。
1. 升级文件大小不能大于芯片内部flash，否则需要压缩代码。



## 8.2. 本地升级

**1、程序配置：**

```
#define TCFG_APP_MUSIC_EN             1
#define TCFG_UDISK_ENABLE             ENABLE_THIS_MOUDLE//U盘模块使能
```

**2、准备一个空U盘，U盘内只放ufw升级文件**

![img186](/pic/186.png)

**3、插入U盘，等待升级完成，程序复位重启**

- 开机状态下插入U盘，并且一定确保样机能正确识别并读取U盘

升级完成后，发出嘟嘟声：

![img187](/pic/187.png)



## 8.3. FAQ

**1、升级时配置是否擦VM和蓝牙配置区**

> 无线升级、U/卡升级或串口升级时是可以配置是否擦VM配置区和蓝牙配置区的。但是否起作用，要看升级进去的代码量相对于样机中的代码量相差多少，是否会多出或减少一个扇区（扇区擦除）。若代码修改后，代码多出或减少一个扇区量则配置会不起作用（会被覆盖）。所以要以实际测试为准。

设置升级是否擦VM或蓝牙配置区的demo:

AC696X demo:

![img188](/pic/188.png)

**2、杰理之家单备份OTA，VM数据是否保留**

![img189](/pic/189.png)